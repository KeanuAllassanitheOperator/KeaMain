[Service]
# Use systemd for cgroups
ExecStart=
ExecStart=/usr/bin/dockerd --host=fd:// --exec-opt native.cgroupdriver=systemd

# Limit container-induced pressure on host
LimitNOFILE=1048576
LimitNPROC=65535
LimitCORE=infinity

# CPU and IO prioritization
CPUAccounting=true
IOAccounting=true
MemoryAccounting=true

# Throttle background CPU usage (adjust for server class)
CPUShares=1024

# Optional: Restrict Docker to certain CPUs (e.g., isolate from critical host tasks)
# AllowedCPUs=0,1,2,3

# Optional: Restrict memory usage if needed
# MemoryMax=8G

# Optional: I/O weight tuning (1-10000, higher = higher priority)
# IOWeight=1000